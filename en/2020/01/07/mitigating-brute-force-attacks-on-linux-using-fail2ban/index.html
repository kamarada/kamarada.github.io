<!DOCTYPE html>
<html lang="en" prefix="
    addthis: http://www.addthis.com/help/api-spec
    og: http://ogp.me/ns#
    fb: http://ogp.me/ns/fb#
    article: http://ogp.me/ns/article#">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    
        <script type="text/javascript">
            if (("kamarada.github.io" == window.location.host) && (window.location.protocol != "https:")) {
                window.location = window.location.toString().replace(/^http:/, "https:");
            }
        </script>
    

    <title>
        
            
                Mitigating brute force attacks on Linux using fail2ban - Linux Kamarada
            
        
    </title>
    <meta name="author" content="Antônio Vinícius">
    <meta name="description" content="Commonly, restricted access systems authenticate their users by requesting a combination of username (a.k.a login) and password.A brute-force attack is a typ...">
    <link rel="canonical" href="https://kamarada.github.io/en/2020/01/07/mitigating-brute-force-attacks-on-linux-using-fail2ban/">
    <link rel="alternate" type="application/rss+xml" title="Linux Kamarada" href="https://kamarada.github.io/en/feed.xml" />

    
    
        
    
        
            <link rel="alternate" hreflang="pt" href="https://kamarada.github.io/pt/2019/12/14/mitigando-ataques-de-forca-bruta-no-linux-com-fail2ban/" />
        
    

    <!-- OpenSearch -->
    <link rel="search" type="application/opensearchdescription+xml" title="Search Linux Kamarada" href="https://kamarada.github.io/en/opensearch.xml" />

    <!-- Open Graph -->
    
        <meta property="article:published_time" content="2020-01-07 07:30:00 -0300"/>
        
            <meta property="article:publisher" content="https://facebook.com/LinuxKamarada" />
        
    
    
        <meta property="fb:app_id" content="2998145206923971" />
    
    
        <meta property="fb:page_id" content="1700979763454346" />
    
    <meta property="og:description" content="Commonly, restricted access systems authenticate their users by requesting a combination of username (a.k.a login) and password.A brute-force attack is a typ..." />
    
        <meta property="og:image" content="https://kamarada.github.io/files/2019/12/fail2ban.jpg" />
    
    <meta property="og:site_name" content="Linux Kamarada" />
    <meta property="og:title" content="Mitigating brute force attacks on Linux using fail2ban" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://kamarada.github.io/en/2020/01/07/mitigating-brute-force-attacks-on-linux-using-fail2ban/" />

    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary" />
    
        <meta name="twitter:site" content="@LinuxKamaradaWW" />
    

    <!-- Favicons (made with RealFaviconGenerator.net) -->
    <link rel="apple-touch-icon" sizes="180x180" href="https://kamarada.github.io/apple-touch-icon.png?v=5">
    <link rel="icon" type="image/png" sizes="32x32" href="https://kamarada.github.io/favicon-32x32.png?v=5">
    <link rel="icon" type="image/png" sizes="16x16" href="https://kamarada.github.io/favicon-16x16.png?v=5">
    <link rel="manifest" href="https://kamarada.github.io/site.webmanifest?v=5">
    <link rel="mask-icon" href="https://kamarada.github.io/safari-pinned-tab.svg?v=5" color="#43a047">
    <link rel="shortcut icon" href="https://kamarada.github.io/favicon.ico?v=5">
    <meta name="msapplication-TileColor" content="#43a047">
    <meta name="theme-color" content="#43a047">

    <!-- CSS -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Material+Icons">
    
        <!--<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">-->
        <!--<link rel="stylesheet" href="https://unpkg.com/bootstrap-material-design@4.1.2/dist/css/bootstrap-material-design.min.css" integrity="sha384-dI6l3oYG+wVvjfdlixt6+FMddrb9+uejLU/wMhQFKklk7RDtSDBfe/XuF1dkcgVV" crossorigin="anonymous">-->
        <link rel="stylesheet" href="/libs/bootstrap-material-design/4.1.2/custom/bootstrap-material-design.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css" integrity="sha256-0fuNgzfNIlaClbDtmYyFxY8LTNCDrwsNshywr4AALy0=" crossorigin="anonymous">
    
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <link rel="stylesheet" href="/assets/css/main.css">

    <!-- JS -->
    
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>
        <script src="https://unpkg.com/popper.js@1.16.1-lts/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
        <!--<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>-->
        <script src="https://unpkg.com/bootstrap-material-design@4.1.2/dist/js/bootstrap-material-design.min.js" integrity="sha384-aWO+CcMRDQLEvnT8RdnCxWbs4C76Ryoo4pzYpGNW2vlHTHiPA7gpBzIB5nYwYfLg" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/js/all.js" integrity="sha256-pvPP8sWBrowznHv1xsjTBO7/74OBKzmOCGaEeq3q+TQ=" crossorigin="anonymous"></script>
        <script src="/assets/js/adsbygoogle.js"></script>
    
    <script src="/assets/js/main.js"></script>

    
        <!-- Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-65333685-3"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'UA-65333685-3');
        </script>
        <!-- End Google Analytics -->
    

    
        <!-- Google AdSense -->
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    

    
        
            <!-- AddThis -->
            <script async src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-563f92aa117815bd"></script>
            <script type="text/javascript">
                var addthis_config = {
                    data_track_clickback: true,
                    data_track_addressbar: true,
                    
                        ui_language: 'en'
                    
                };
                var addthis_share = {
                    url: 'https://kamarada.github.io/en/2020/01/07/mitigating-brute-force-attacks-on-linux-using-fail2ban/',
                    title: document.title,
                    description: 'Commonly, restricted access systems authenticate their users by requesting a combination of username (a.k.a login) and password.A brute-force attack is a typ...'
                };
            </script>
            <!-- End AddThis -->
        
    
</head>


<body itemscope itemtype="http://schema.org/BlogPosting">
    
        <!-- Facebook SDK -->
        <div id="fb-root"></div>
        <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v4.0&appId=&autoLogAppEvents=1"></script>
        <!-- End Facebook SDK -->
    

    <div class="bmd-layout-container bmd-drawer-f-l bmd-drawer-overlay">
        <!-- Fixed navbar -->
<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-primary">
    <div class="container">
        <button type="button" class="navbar-toggler" data-toggle="drawer" data-target="#drawer">
            <span class="sr-only">
                
                    Toggle drawer
                
            </span>
            <i class="material-icons">menu</i>
        </button>

        <a class="navbar-brand" href="/">
            
                Linux Kamarada
            
        </a>

        <div class="collapse navbar-collapse" id="navbar">
            <ul class="navbar-nav m-auto">
                

                
                    
                        <li class="nav-item">
                            <a class="nav-link" href="/en/download">Download</a>
                        </li>
                    
                        <li class="nav-item">
                            <a class="nav-link" href="/en/help">Help</a>
                        </li>
                    
                        <li class="nav-item">
                            <a class="nav-link" href="/en/contribute">Contribute</a>
                        </li>
                    
                
            </ul>
            <form action="/en/search/" class="form-inline search-form" id="navbar-search-form" method="get" role="search">
                
                
                <div class="input-group">
                    <input class="form-control search-field" id="navbar-search-field" name="q" placeholder="Search" type="text" aria-label="Search">
                    <div class="input-group-append">
                        <button class="btn btn-secondary btn-number search-button" id="navbar-search-button" type="submit">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>
                </div>
                <div class="dropdown">
                    <a class="dropdown-toggle" id="navbar-language-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="Translations" href="#" role="button"><i class="fas fa-globe-americas" aria-hidden="true"></i></a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbar-language-button">
                        
                        
                            <h6 class="dropdown-header">English</h6>
                            
                            
                                <a class="dropdown-item translation-en" href="https://kamarada.github.io/en/2020/01/07/mitigating-brute-force-attacks-on-linux-using-fail2ban/">This page in English</a>
                            
                            <a class="dropdown-item" href="https://kamarada.github.io/en/">English home page</a>
                            <div class="dropdown-divider"></div>
                        
                            <h6 class="dropdown-header">Português</h6>
                            
                            
                                <a class="dropdown-item translation-pt" href="https://kamarada.github.io/pt/2019/12/14/mitigando-ataques-de-forca-bruta-no-linux-com-fail2ban/">Esta página em Português</a>
                            
                            <a class="dropdown-item" href="https://kamarada.github.io/pt/">Página inicial em Português</a>
                            <div class="dropdown-divider"></div>
                        
                        <h6 class="dropdown-header">Other languages (by Google Translate)</h6>
                        <a class="dropdown-item" href="http://translate.google.com/translate?js=n&sl=en&u=https://kamarada.github.io/en/2020/01/07/mitigating-brute-force-attacks-on-linux-using-fail2ban/">Translate this page</a>
                    </div>
                </div><!--.dropdown-->
            </form>
        </div><!--#navbar-->
    </div><!--.container-->
</nav>

        <!-- Navigation drawer -->
<div id="drawer" class="bmd-layout-drawer bg-faded">
    <header>
        <a class="navbar-brand" href="/">
            
                Linux Kamarada
            
        </a>
    </header>
    <form action="/en/search/" class="form-inline border-top" id="drawer-search-form" method="get" role="search">
        
        
        <div class="bmd-form-group-sm">
            <div class="input-group">
                <input class="form-control search-field" id="drawer-search-field" name="q" placeholder="Search" type="text" aria-label="Search">
                <div class="input-group-append">
                    <button class="btn btn-secondary btn-number search-button" id="drawer-search-button" type="submit">
                        <i class="fa fa-search"></i>
                    </button>
                </div>
            </div><!-- .input-group -->
        </div><!-- .bmd-form-group-sm -->
    </form>
    <ul class="list-group list-group-flush border-top" id="drawer-links">
        

        
            
                <li class="nav-item">
                    <a class="nav-link" href="/en/download">Download</a>
                </li>
            
                <li class="nav-item">
                    <a class="nav-link" href="/en/help">Help</a>
                </li>
            
                <li class="nav-item">
                    <a class="nav-link" href="/en/contribute">Contribute</a>
                </li>
            
        
    </ul>

    <div class="btn-group mb-3 mt-3">
        <button type="button" class="btn btn-secondary" id="drawer-language-button">
            <i class="fas fa-globe-americas" aria-hidden="true"></i> English
        </button>
    </div>
</div><!--.drawer-->


        <main class="bmd-layout-content">
            <div class="container" id="main-container">
                <div class="row">
                    <div class='col-sm-8'>
                        <!--<div class='gap-small'>
                            <a href='http://en.opensuse.org/Portal:15.2'>
                                <img class='img-fluid' id='countdown' src='http://countdown.opensuse.org/wide.en.png'/>
                            </a>
                        </div>-->
                        <div class="blog-post card mb-3">
    <header class="card-header">
        <h1 class="blog-post-title" itemprop="headline name">
            <a class="blog-post-link" href="/en/2020/01/07/mitigating-brute-force-attacks-on-linux-using-fail2ban/" itemprop="mainEntityOfPage url">
                Mitigating brute force attacks on Linux using fail2ban
            </a>
        </h1>
        <div class="blog-post-meta row">
            <div class='col-sm-6'>
                <p class="blog-post-date" itemprop="datePublished" content="2020-01-07">
                    <a href="/2020/01/07/">
                        
    Jan 7, 2020


                    </a>
                </p>
                <meta itemprop="dateModified" content="2020-01-07" />
            </div>
            <div class='col-sm-6'>
                
                    <div class='blog-post-share'>
                        <!-- AddThis Sharing Buttons -->
                        <div class="addthis_toolbox addthis_default_style">
                            <a class="addthis_button_facebook"></a>
                            <a class="addthis_button_twitter" data-via="LinuxKamaradaWW"></a>
                            <a class="addthis_button_telegram"></a>
                            <a class="addthis_button_favorites"></a>
                            <a class="addthis_button_compact"></a>
                            <a class="addthis_counter addthis_bubble_style"></a>
                        </div>
                        <!-- AddThis Sharing Buttons End -->
                    </div><!-- .blog-post-share -->
                
            </div><!-- .col-sm-6 -->
        </div><!-- .blog-post-meta -->
    </header>

    <article class="blog-post-content card-body">
        
            
    <!-- Google AdSense -->
    <ins class="adsbygoogle" id="content_ad_unit_1"
        style="display:block"
        data-ad-client="ca-pub-5193467168351289"
        data-ad-slot="8945658251"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <!-- End Google AdSense -->
    <div class="alert alert-danger please-allow-ads d-none" role="alert">
        <div class="media">
            <img class="mr-3" src="/assets/icons/other/detective_penguin.svg" alt="Detective penguin" style="max-width: 64px;">
            <div class="media-body">
                <h6 class="alert-heading mt-0">Have you seen the ad that should be here?</h6>
                It seems like you're using an ad blocker. But we depend on advertising to keep creating quality content for you to enjoy for free. If you enjoy our content, please support our website by disabling your ad blocker. Alternatively, if you come here often, please consider <a href='/en/contribute'>making a donation</a>.
            </div>
        </div>
    </div>


        

        <div itemprop="articleBody mainEntity">
            <div class="image no-ads-here text-center mb-3" itemscope="" itemtype="http://schema.org/ImageObject">
<a href="/files/2019/12/fail2ban.jpg" title="">
<img src="/files/2019/12/fail2ban.jpg" alt="" class="img-fluid img-thumbnail" itemprop="contentUrl" />
</a>

</div>

<p>Commonly, restricted access systems authenticate their users by requesting a combination of username (a.k.a <em>login</em>) and password.</p>

<p>A <a href="https://en.wikipedia.org/wiki/Brute-force_attack"><strong>brute-force attack</strong></a> is a type of attack that consists in trying to guess a combination of username and password that grants access to a system. If an attacker knows at least an existing username, they are already halfway, because then they only need to find out the corresponding password. This is usually done on a trial and error basis, testing all possible passwords (e.g. <code class="highlighter-rouge">aaaa</code>, <code class="highlighter-rouge">aaab</code>, <code class="highlighter-rouge">aaac</code> … <code class="highlighter-rouge">1234</code>, <code class="highlighter-rouge">1235</code>, etc).</p>

<p>It’s one of the simplest and oldest attack methods, but it’s still used and, believe it or not, effective, as many people use short, weak, easy to guess or even obvious passwords. Depending on the length and complexity of a password, a brute-force attack can take anywhere from a few seconds to many years to discover it.</p>

<p><a href="https://www.kernel.org/linux.html">Linux</a> sysadmins need to protect servers against attacks and illegitimate access. We’ve already talked about the <a href="/en/2019/11/24/protect-yourself-with-the-iptables-firewall/"><strong>iptables</strong> firewall</a>, which acts on the layers 2 and 3 (network and transport) of the TCP/IP model. It can stop brute-force attacks, which occur at the layer 4 (application), with the help of a tool called <strong>fail2ban</strong>.</p>

<h2 id="what-is-fail2ban">What is fail2ban?</h2>

<p><strong><a href="https://www.fail2ban.org/">fail2ban</a></strong> is an <a href="https://en.wikipedia.org/wiki/Intrusion_detection_system#Intrusion_prevention">intrusion prevention system (IPS)</a> in the form of a <a href="https://en.wikipedia.org/wiki/Daemon_(computing)">daemon</a> that monitors login attempts to system services and takes immediate action when it detects an IP address that behaves suspiciously — too many password failures, seeking for exploits, etc.</p>

<p><strong>fail2ban</strong> works by continuously scanning system logs (such as <code class="highlighter-rouge">/var/log/messages</code>, <code class="highlighter-rouge">/var/log/apache2/access_log</code>, <code class="highlighter-rouge">/var/log/apache2/error_log</code>, etc.) looking for failed login attempts. It’s able to monitor various network services out-of-the-box, such as SSH, Apache, FTP, SMTP, MySQL, etc. Usually the action taken by <strong>fail2ban</strong> against an offending host is to add a rule to <strong>iptables</strong> to reject its IP address for a specified amount of time, although any other arbitrary action can also be configured (e.g. sending an email to the sysadmin).</p>

<div class="alert alert-warning" role="alert">

<p>Note that <strong>fail2ban</strong> reduces the rate of incorrect authentication attempts, however it cannot eliminate the inherent risk of weak authentication methods (for instance, if a user’s password is <code>123456</code>, and an attacker starts a brute-force attack by testing just that password, access to the system will be granted right on the first try). To increase the security of services, configure them to use more secure authentication mechanisms, such as two-factor authentication or public-key authentication.</p>

</div>

<h2 id="installing-fail2ban">Installing fail2ban</h2>

<div class="alert alert-info" role="alert">

<p>Repeating the recommendation I gave on the <a href="/en/2019/11/24/protect-yourself-with-the-iptables-firewall/"><strong>iptables</strong> tutorial</a>, to follow this tutorial, I recommend that you use a virtual machine. Doing that, you don’t need to modify your server or desktop settings until you are familiar with <strong>fail2ban</strong>.</p>

<p>For more information, read:</p>

<ul>
  <li><a href="/en/2019/10/10/virtualbox-the-easiest-way-to-try-linux-without-installing-it/">VirtualBox: the easiest way to try Linux without installing it</a></li>
</ul>

</div>

<p>To install <strong>fail2ban</strong> on <a href="https://www.opensuse.org/">openSUSE</a> and based distributions (such as <a href="/en/2019/09/13/first-beta-release-of-the-kamarada-linux-distribution/">Linux Kamarada</a>), run the following command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre># zypper in fail2ban
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="configuring-fail2ban">Configuring fail2ban</h2>

<p>By default, <strong>fail2ban</strong> keeps its configuration files in the <code class="highlighter-rouge">/etc/fail2ban/</code> folder:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre># cd /etc/fail2ban
# ls -lah
total 40K
drwxr-xr-x 6 root root  220 Jan  5 13:29 .
drwxr-xr-x 1 root root  780 Jan  5 13:29 ..
drwxr-xr-x 2 root root 1.3K Jan  5 13:29 action.d
-rw-r--r-- 1 root root 2.3K Oct  4  2018 fail2ban.conf
drwxr-xr-x 2 root root   40 Mar 27  2019 fail2ban.d
drwxr-xr-x 3 root root 1.7K Jan  5 13:29 filter.d
-rw-r--r-- 1 root root  23K Mar 27  2019 jail.conf
drwxr-xr-x 2 root root   40 Mar 27  2019 jail.d
-rw-r--r-- 1 root root   71 Mar 27  2019 jail.local
-rw-r--r-- 1 root root 2.8K Mar 27  2019 paths-common.conf
-rw-r--r-- 1 root root  975 Mar 27  2019 paths-opensuse.conf
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The main configuration files are <code class="highlighter-rouge">fail2ban.conf</code> and <code class="highlighter-rouge">jail.conf</code>. It’s not recommended to directly edit them, because they belong to the <a href="https://software.opensuse.org/package/fail2ban"><strong>fail2ban</strong></a> RPM package and may be overwritten during system updates, causing changes to be lost. Instead of editing them, create copies named <code class="highlighter-rouge">fail2ban.local</code> and <code class="highlighter-rouge">jail.local</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre># cp fail2ban.conf fail2ban.local
# cp jail.conf jail.local
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>fail2ban</strong> first reads <code class="highlighter-rouge">.conf</code> files, then <code class="highlighter-rouge">.local</code> files, with later settings overriding earlier ones. Thus, a <code class="highlighter-rouge">.local</code> file doesn’t have to include everything in the corresponding <code class="highlighter-rouge">.conf</code> file, only those settings that you wish to override. An alternative to copying would be creating new text files named <code class="highlighter-rouge">fail2ban.local</code> and <code class="highlighter-rouge">jail.local</code> and adding to them only settings that should differ from the defaults.</p>

<p>Those files are self-documented and detailed information should be available on them.</p>

<p>Next, we are going to see the main <strong>fail2ban</strong> settings.</p>

<h3 id="general-settings-fail2banlocal">General settings (fail2ban.local)</h3>

<p>The <code class="highlighter-rouge">fail2ban.conf</code> file (and its corresponding <code class="highlighter-rouge">fail2ban.local</code>) contains general <strong>fail2ban</strong> settings, such as the logging level and target.</p>

<p>Let’s take a look at the most relevant excerpts from this file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>[Definition]

# Option: loglevel
# Notes.: Set the log level output.
#         CRITICAL
#         ERROR
#         WARNING
#         NOTICE
#         INFO
#         DEBUG
# Values: [ LEVEL ]  Default: ERROR
#
loglevel = INFO
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The <code class="highlighter-rouge">loglevel</code> option sets the logging verbosity level. By default, the level is <code class="highlighter-rouge">INFO</code> , meaning <strong>fail2ban</strong> logs simple information as well as errors and more critical messages. It already provides a good level of detail.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre># Option: logtarget
# Notes.: Set the log target. This could be a file, SYSLOG, STDERR or STDOUT.
#         Only one log target can be specified.
#         If you change logtarget from the default value and you are
#         using logrotate -- also adjust or disable rotation in the
#         corresponding configuration file
#         (e.g. /etc/logrotate.d/fail2ban on Debian systems)
# Values: [ STDOUT | STDERR | SYSLOG | SYSOUT | FILE ]  Default: STDERR
#
logtarget = /var/log/fail2ban.log
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The <code class="highlighter-rouge">logtarget</code> option sets where the log should be written. By default, <strong>fail2ban</strong> logs to the <code class="highlighter-rouge">/var/log/fail2ban.log</code> file. You can refer to this file when you need to check if everything is working well.</p>

<p>Normally, you don’t need to change the file <code class="highlighter-rouge">fail2ban.conf</code> (or <code class="highlighter-rouge">fail2ban.local</code>).</p>

<h3 id="general-jail-settings-jaillocal">General jail settings (jail.local)</h3>

<p>The <code class="highlighter-rouge">jail.conf</code> file (and its corresponding <code class="highlighter-rouge">jail.local</code>) is probably the most important file. It contains the declaration and configuration of the <strong>jails</strong>, which correspond to the services monitored by <strong>fail2ban</strong>. By default, all jails are disabled. You need to enable the ones you need and adapt their settings to your server configuration.</p>

<p>The <code class="highlighter-rouge">jail.local</code> file has sections. Each jail has its own section. At the beginning of the file, before the sections of the jails, there is a <code class="highlighter-rouge">[DEFAULT]</code> section. Settings in this section apply to all jails. Specific settings can be overridden by specific jails afterwards, if necessary.</p>

<p>Let’s take a look at the most relevant excerpts from the <code class="highlighter-rouge">[DEFAULT]</code> section:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre># The DEFAULT allows a global definition of the options. They can be overridden
# in each jail afterwards.

[DEFAULT]

...

# "ignoreip" can be a list of IP addresses, CIDR masks or DNS hosts. Fail2ban
# will not ban a host which matches an address in this list. Several addresses
# can be defined using space (and/or comma) separator.
#ignoreip = 127.0.0.1/8 ::1
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The <code class="highlighter-rouge">ignoreip</code> option allows us to define exceptions to the <strong>fail2ban</strong> monitoring. The value of this option is a list that can contain any of the following:</p>

<ul>
  <li>a host IP address (e.g. <code class="highlighter-rouge">127.0.0.1</code>);</li>
  <li>a network/subnet IP address followed by the network mask in <a href="https://doc.m0n0.ch/quickstartpc/intro-CIDR.html">CIDR</a> notation (e.g. <code class="highlighter-rouge">192.168.0.1/24</code>);</li>
  <li>a hostname (e.g. <code class="highlighter-rouge">www</code>); or</li>
  <li>a fully qualified domain name (<a href="https://en.wikipedia.org/wiki/Fully_qualified_domain_name">FQDN</a>, e.g. <code class="highlighter-rouge">kamarada.github.io</code>).</li>
</ul>

<p>Exceptions must be separated by space and/or comma. <strong>fail2ban</strong> will not take action against a host that matches an address in this list.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre># "bantime" is the number of seconds that a host is banned.
bantime  = 10m

# A host is banned if it has generated "maxretry" during the last "findtime"
# seconds.
findtime  = 10m

# "maxretry" is the number of failures before a host get banned.
maxretry = 5
</pre></td></tr></tbody></table></code></pre></div></div>

<p>In my humble opinion, these options would make more sense listed in reverse. Let’s see.</p>

<p>The <code class="highlighter-rouge">maxretry</code> option sets how many login attempts can fail before <strong>fail2ban</strong> takes action against the host trying to log in.</p>

<p>The <code class="highlighter-rouge">findtime</code> option sets how often the failed login count gets reset.</p>

<p>The <code class="highlighter-rouge">bantime</code> option sets how long a offending host is banned.</p>

<p>We can read the default settings like this: one who misses their password 5 times (<code class="highlighter-rouge">maxretry</code>) during the last 10 minutes (<code class="highlighter-rouge">findtime</code>) will have their host locked for 10 minutes (<code class="highlighter-rouge">bantime</code>), that is, from the last failed login attempt, they will have to wait 10 minutes to be able to try again.</p>

<p>It looks like the default values for those options are great, but you can change them as you need.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>#
# ACTIONS
#

# Some options used for actions

# Destination email address used solely for the interpolations in
# jail.{conf,local,d/*} configuration files.
destemail = root@localhost

# Sender email address used solely for some actions
sender = root@&lt;fq-hostname&gt;

# E-mail action. Since 0.8.1 Fail2Ban uses sendmail MTA for the
# mailing. Change mta configuration parameter to mail if you want to
# revert to conventional 'mail'.
mta = sendmail
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The <code class="highlighter-rouge">destemail</code> option sets the email address to which <strong>fail2ban</strong> should send ban notifications for the jails that have email notifications enabled. Similarly, the <code class="highlighter-rouge">sender</code> option sets the email address that will be informed as the sender of the email message.</p>

<p>The <code class="highlighter-rouge">mta</code> option sets the program that <strong>fail2ban</strong> will use to send email notifications. By default, <a href="http://www.sendmail.org/">Sendmail</a>. Note that email notifications are actually sent only if this program is installed and set up.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre># Choose default action.  To change, just override value of 'action' with the
# interpolation to the chosen action shortcut (e.g.  action_mw, action_mwl, etc) in jail.local
# globally (section [DEFAULT]) or per specific section
action = %(action_)s
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The <code class="highlighter-rouge">action</code> option sets the action that <strong>fail2ban</strong> should take upon identifying suspicious behavior of a host. In the <code class="highlighter-rouge">[DEFAULT]</code> section, this option sets the default action for all jails. In the <code class="highlighter-rouge">jail.local</code> file, above the <code class="highlighter-rouge">action</code> option, some action options are defined (<code class="highlighter-rouge">action_</code>, <code class="highlighter-rouge">action_mw</code>, <code class="highlighter-rouge">action_mwl</code>, etc). The default value is <code class="highlighter-rouge">action_</code>, which corresponds to the simplest action to take: ban only. If you have set up email sending, you may want to change the value of this option to <code class="highlighter-rouge">action_mw</code>, which corresponds to: ban and notify by email.</p>

<h3 id="configuring-the-ssh-jail">Configuring the SSH jail</h3>

<p><strong>fail2ban</strong> is able to monitor various services. For instance, let’s see how to configure it to monitor SSH login attempts. To do this, let’s go to the <code class="highlighter-rouge">[sshd]</code> section of the <code class="highlighter-rouge">jail.local</code> file.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>[sshd]

# To use more aggressive sshd modes set filter parameter "mode" in jail.local:
# normal (default), ddos, extra or aggressive (combines all).
# See "tests/files/logs/sshd" or "filter.d/sshd.conf" for usage example and details.
#mode   = normal
port    = ssh
logpath = %(sshd_log)s
backend = %(sshd_backend)s
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Start by adding <code class="highlighter-rouge">enabled = true</code> to enable this jail.</p>

<p>The <code class="highlighter-rouge">port</code> option sets the port on which the service listens. If the service listens on the default port (in the case of SSH, port 22), leave the default value, which is the service name (<code class="highlighter-rouge">ssh</code>). If the service listens on a port other than the default, enter the port number here.</p>

<p>The <code class="highlighter-rouge">logpath</code> option sets the path to the service log file. Similarly, change the value of this option only if the service logs to a file other than the default.</p>

<h2 id="starting-fail2ban">Starting fail2ban</h2>

<p>With the initial setup done, it’s time to start <strong>fail2ban</strong>. To do this, run:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre># systemctl start fail2ban
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Make sure <strong>fail2ban</strong> is running by checking the service status:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre># systemctl status fail2ban
● fail2ban.service - Fail2Ban Service
   Loaded: loaded (/usr/lib/systemd/system/fail2ban.service; disabled; vendor preset: disabled)
   Active: active (running) since Mon 2020-01-05 15:52:15 EST; 2s ago
     Docs: man:fail2ban(1)
  Process: 8100 ExecStartPre=/bin/mkdir -p /var/run/fail2ban (code=exited, status=0/SUCCESS)
 Main PID: 8101 (fail2ban-server)
    Tasks: 1 (limit: 4915)
   CGroup: /system.slice/fail2ban.service
           └─8101 /usr/bin/python /usr/bin/fail2ban-server -xf start

Jan 05 15:52:15 kamarada-pc systemd[1]: Starting Fail2Ban Service...
Jan 05 15:52:15 kamarada-pc systemd[1]: Started Fail2Ban Service.
Jan 05 15:52:15 kamarada-pc fail2ban-server[8101]: Server ready
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Enable the <strong>fail2ban</strong> service, so that it gets started automatically at boot time:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre># systemctl enable fail2ban
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="testing-fail2ban">Testing fail2ban</h2>

<p>Let’s see <strong>fail2ban</strong> acting in practice.</p>

<div class="alert alert-danger" role="alert">

<p><strong>Do not</strong> try running the commands in this tutorial on a remote server that you access via SSH: you will risk losing access to the server.</p>

</div>

<p>Using a computer different from the one on which you installed <strong>fail2ban</strong>, try to remotely connect via SSH, but enter a wrong password on purpose a few times:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>$ ssh kamarada@10.0.0.250
Password:
Password:
Password:
kamarada@10.0.0.250's password:
Permission denied, please try again.
kamarada@10.0.0.250's password:
Received disconnect from 10.0.0.250 port 22:2: Too many authentication failures
Disconnected from 10.0.0.250 port 22
</pre></td></tr></tbody></table></code></pre></div></div>

<p>If you exceed the configured login attempts limit, you will be disconnected from the server.</p>

<p>Note that subsequent login attempts are immediately refused:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>$ ssh kamarada@10.0.0.250
ssh: connect to host 10.0.0.250 port 22: Connection refused
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="checking-the-fail2ban-log">Checking the fail2ban log</h2>

<p>As we have seen, by default <strong>fail2ban</strong> logs to the <code class="highlighter-rouge">/var/log/fail2ban.log</code> file.</p>

<p>To open that file, you can use commands such as <strong><a href="http://man7.org/linux/man-pages/man1/cat.1.html">cat</a></strong>, <strong><a href="http://man7.org/linux/man-pages/man1/less.1.html">less</a></strong> or <strong><a href="http://man7.org/linux/man-pages/man1/tail.1.html">tail</a></strong>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre># less /var/log/fail2ban.log
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The <strong>fail2ban</strong> log shows our failed login attempts and the effective banning:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>2020-01-05 23:24:01,169 fail2ban.filter         [6803]: INFO    [sshd] Found 10.0.0.10 - 2020-01-05 23:24:00
2020-01-05 23:24:04,638 fail2ban.filter         [6803]: INFO    [sshd] Found 10.0.0.10 - 2020-01-05 23:24:04
2020-01-05 23:24:07,919 fail2ban.filter         [6803]: INFO    [sshd] Found 10.0.0.10 - 2020-01-05 23:24:07
2020-01-05 23:24:12,335 fail2ban.filter         [6803]: INFO    [sshd] Found 10.0.0.10 - 2020-01-05 23:24:12
2020-01-05 23:24:12,361 fail2ban.filter         [6803]: INFO    [sshd] Found 10.0.0.10 - 2020-01-05 23:24:12
2020-01-05 23:24:12,896 fail2ban.actions        [6803]: NOTICE  [sshd] Ban 10.0.0.10
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="checking-iptables-rules">Checking iptables rules</h2>

<p>To ban hosts with suspicious behavior, <strong>fail2ban</strong> adds firewall rules to <strong>iptables</strong>.</p>

<p>If you list the rules currently in use by <strong>iptables</strong>, you will see the rule added by <strong>fail2ban</strong>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre># iptables -L
Chain INPUT (policy ACCEPT)
target     prot opt source               destination         
f2b-sshd   tcp  --  anywhere             anywhere             multiport dports ssh

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         

Chain f2b-sshd (1 references)
target     prot opt source               destination         
RETURN     all  --  anywhere             anywhere
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Note that <strong>fail2ban</strong> creates its own chains to manage its rules.</p>

<h2 id="unbanning-an-ip-address">Unbanning an IP address</h2>

<p>It may happen that a legitimate server user has forgotten their password and has been locked out by <strong>fail2ban</strong> after successive failed login attempts. In this case, you may want to unban the user’s computer so that they can access the server again.</p>

<p>To properly unban a host previously banned by <strong>fail2ban</strong>, run:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre># fail2ban-client set JAIL unbanip IP_ADDRESS
</pre></td></tr></tbody></table></code></pre></div></div>

<p>For instance:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre># fail2ban-client set sshd unbanip 10.0.0.10
</pre></td></tr></tbody></table></code></pre></div></div>

<p>If you try to remotely access the server via SSH, this time entering the correct password, you will be able to log in.</p>

<h2 id="stopping-fail2ban">Stopping fail2ban</h2>

<p>If for any reason you need to stop the <strong>fail2ban</strong> monitoring, run:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>$ systemctl stop fail2ban
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Please note that stopping <strong>fail2ban</strong> causes the deletion of any rules added to <strong>iptables</strong> by <strong>fail2ban</strong>, thus allowing any previously blocked hosts to make new login attempts to the server.</p>

<h2 id="incrementing-the-iptables-script">Incrementing the iptables script</h2>

<p>On <a href="/en/2019/11/24/protect-yourself-with-the-iptables-firewall/">the previous post about <strong>iptables</strong></a>, we created a script to start and set up <strong>iptables</strong> at boot time. Now we can increment that script by stopping <strong>fail2ban</strong> before clearing the rules and starting it again at the end:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>
<span class="nb">set</span> <span class="nt">-ex</span>

<span class="c"># Stop fail2ban</span>
systemctl stop fail2ban

<span class="c"># Cleanup</span>
iptables <span class="nt">-F</span>
iptables <span class="nt">-X</span>
iptables <span class="nt">-t</span> nat <span class="nt">-F</span>
iptables <span class="nt">-t</span> nat <span class="nt">-X</span>
iptables <span class="nt">-t</span> mangle <span class="nt">-F</span>
iptables <span class="nt">-t</span> mangle <span class="nt">-X</span>
iptables <span class="nt">-t</span> raw <span class="nt">-F</span>
iptables <span class="nt">-t</span> raw <span class="nt">-X</span>

<span class="c"># Default policy: block all incoming connections</span>
iptables <span class="nt">-P</span> FORWARD DROP
iptables <span class="nt">-P</span> INPUT DROP
iptables <span class="nt">-P</span> OUTPUT ACCEPT

<span class="c"># Allow previously established connections</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-m</span> state <span class="nt">--state</span> ESTABLISHED,RELATED <span class="nt">-j</span> ACCEPT

<span class="c"># Allow loopback connections</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-i</span> lo <span class="nt">-j</span> ACCEPT

<span class="c"># SSH (port 22/TCP,UDP)</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 22 <span class="nt">-j</span> ACCEPT
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> udp <span class="nt">--dport</span> 22 <span class="nt">-j</span> ACCEPT

<span class="c"># HTTP (port 80/TCP)</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 80 <span class="nt">-j</span> ACCEPT

<span class="c"># Start fail2ban</span>
systemctl start fail2ban
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="references">References</h2>

<p>I hope this text was helpful. Timely, as we study different types of servers (web server, database server, FTP server, mail server, etc), we will see how we can protect them using the <strong>iptables</strong> and <strong>fail2ban</strong> duo.</p>

<p>If you have any questions or helpful information to add, please leave a comment.</p>

<p>See you!</p>

<ul>
  <li><a href="https://www.kaspersky.com/resource-center/definitions/brute-force-attack">What’s a Brute Force Attack? - Kaspersky</a></li>
  <li><a href="https://www.2daygeek.com/how-to-install-setup-configure-fail2ban-on-linux/">How To Protect Server Against Brute Force Attacks With Fail2ban On Linux - 2daygeek.com</a></li>
  <li><a href="https://www.fail2ban.org/wiki/index.php/MANUAL_0_8">Manual - Fail2ban</a></li>
  <li><a href="https://serverfault.com/a/336001/357679">firewall - How to Unban an IP properly with Fail2Ban - Server Fault</a></li>
  <li><a href="https://www.vivaolinux.com.br/artigo/O-que-e-e-como-funciona-um-ataque-de-forca-bruta">O que é e como funciona um ataque de força bruta - Artigo - Viva o Linux</a> (in Portuguese)</li>
  <li><a href="https://www.vivaolinux.com.br/artigo/Protecao-utilizando-fail2ban-contra-ataques-do-tipo">Proteção utilizando fail2ban contra ataques do tipo - Artigo - Viva o Linux</a> (in Portuguese)</li>
  <li><a href="https://www.vivaolinux.com.br/dica/Fail2ban-Aprendendo-a-instalar-e-configurar">Fail2ban - Aprendendo a instalar e configurar - Dica - Viva o Linux</a> (in Portuguese)</li>
</ul>


        </div>

        
            <!-- AddThis Sharing Buttons -->
            <div class="gap"></div>
            <h2>
                
                    Did you like it? What about sharing?
                
            </h2>
            <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
                <a class="addthis_button_facebook"></a>
                <a class="addthis_button_twitter" data-via="LinuxKamaradaWW"></a>
                <a class="addthis_button_google_plusone_share"></a>
                <a class="addthis_button_email"></a>
                <a class="addthis_button_favorites"></a>
                <a class="addthis addthis_button_print"></a>
                <a class="addthis_button_pdfonline"></a>
                <a class="addthis_button_compact"></a>
                <a class="addthis_counter addthis_bubble_style"></a>
            </div>
            <!-- AddThis Sharing Buttons End -->
        

        <div class="media my-4">
    <img class="mr-3" src="/assets/icons/other/coffee.svg" alt="Would you buy me a coffee?" style='max-width: 48px;'>
    <div class="media-body">
        If you really liked it, if it was really helpful for you, is it worth a coffee? If you want, you can "buy me a coffee" with <a href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=J7F5GPWZX7CJA&no_shipping=1&lc=US" title="PayPal" target="_blank">PayPal</a> or <a href="/en/contribute">contribute to the project in other ways</a>.
    </div>
</div>


        
            
                <!-- Disqus -->
                <div class="gap"></div>
                <h2>
                    
                        Comments
                    
                </h2>
                <div id="disqus_thread"></div>
                <script>
                    var disqus_config = function () {
                        
                            this.language = "en";
                        
                        this.page.url = 'https://kamarada.github.io/en/2020/01/07/mitigating-brute-force-attacks-on-linux-using-fail2ban/';
                    };

                    (function() {
                        var d = document, s = d.createElement('script');

                        s.src = '//kamaradaww.disqus.com/embed.js';

                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                    })();
                </script>
                <noscript>
                    <p>Please <a href="http://www.enable-javascript.com/" target="_blank">enable JavaScript</a> to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus</a>.</p>
                </noscript>
                <!-- Disqus End -->
            
        
    </article>
</div><!-- .blog-post -->

                    </div>
                    <div class="col-sm-4">
                        <div class="card mb-3" id="about">
    <div class="card-header">
      <h3>
          <a name="about"></a>
          
              About
          
      </h3>
    </div>
    <div class="card-body" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
        <meta itemprop="name" content="Linux Kamarada" />
        <meta itemprop="url" content="https://kamarada.github.io" />
        <p class='text-center' itemprop='logo' itemscope itemtype='http://schema.org/ImageObject'>
            <a href='https://kamarada.github.io/assets/img/TuxKamarada.png' itemprop='url'>
                <img src='https://kamarada.github.io/assets/img/TuxKamarada.png' class='img-fluid rounded-circle'>
            </a>
            <!--<meta itemprop="width" content=""/>--><!-- TODO Image width -->
            <!--<meta itemprop="height" content=""/>--><!-- TODO Image height -->
        </p>
        <p class="text" itemprop="description">
            
                The Linux Kamarada Project aims to spread and promote Linux as a robust, secure, versatile and easy to use operating system, suitable for everyday use be at home, at work or on the server. The project focuses mainly on distribution and documentation.

            
        </p>
        
            <!-- AddThis Follow Buttons -->
            <div class="addthis_inline_follow_toolbox_7gt3 text-center"></div>
            <!-- AddThis Follow Buttons End -->
        
    </div><!-- .card-body -->
</div><!-- .card -->


    <div class="card mb-3">
        <div class="card-header">
            <h3>Ads</h3>
        </div>
        <div class="card-body">
            
                
    <!-- Google AdSense -->
    <ins class="adsbygoogle" id="sidebar_ad_unit"
        style="display:block"
        data-ad-client="ca-pub-5193467168351289"
        data-ad-slot="7329324255"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <!-- End Google AdSense -->
    <div class="alert alert-danger please-allow-ads d-none" role="alert">
        <div class="media">
            <img class="mr-3" src="/assets/icons/other/detective_penguin.svg" alt="Detective penguin" style="max-width: 64px;">
            <div class="media-body">
                <h6 class="alert-heading mt-0">Have you seen the ad that should be here?</h6>
                It seems like you're using an ad blocker. But we depend on advertising to keep creating quality content for you to enjoy for free. If you enjoy our content, please support our website by disabling your ad blocker. Alternatively, if you come here often, please consider <a href='/en/contribute'>making a donation</a>.
            </div>
        </div>
    </div>


            

            
    <!-- A-ADS Begin -->
    <iframe data-aa="1585324" src="//acceptable.a-ads.com/1585324" scrolling="no" style="border:0px; padding:0; width:100%; height:100%; overflow:hidden" allowtransparency="true"></iframe>
    <!-- A-ADS End -->


        </div><!-- .card-body -->
    </div><!-- .card -->


<div class="card mb-3" id="donate">
    <div class="card-header">
      <h3>
          <a name="donate"></a>
          Donate
      </h3>
    </div>
    <div class="card-body">
        

    <p>You can make a one-time donation quickly with <a href='https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=J7F5GPWZX7CJA&no_shipping=1&lc=US' title='PayPal' target='_blank'>PayPal</a>:</p>
    <p class="text-center">
        <a href='https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=J7F5GPWZX7CJA&no_shipping=1&lc=US' title='PayPal'>
            <img src='https://kamarada.github.io/assets/img/paypal-en.gif' alt='PayPal' target='_blank'>
        </a>
    </p>
    <!--<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
        <input type="hidden" name="cmd" value="_s-xclick" />
        <input type="hidden" name="hosted_button_id" value="6MZ4CVA2WXLKA" />
        <input type="hidden" name="business" value="linuxkamarada@gmail.com" />
        <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" />
        <img alt="" border="0" src="https://www.paypal.com/en_BR/i/scr/pixel.gif" width="1" height="1" />
    </form>-->

    <p>Or make monthly donations via one of these services:</p>
    <div class="row text-center">
        <div class="col">
            <a href='https://www.patreon.com/bePatron?u=34177146' title='Patreon' target='_blank'>
                <p><img src='https://kamarada.github.io/assets/img/patreon.png' alt='Padrim' class='img-fluid img-thumbnail rounded-circle' style='width: 100px'></p>
                <p>Patreon</p>
            </a>
        </div>
        <div class="col">
            <a href='https://ko-fi.com/LinuxKamarada' title='Ko-fi' target='_blank'>
                <p><img src='https://kamarada.github.io/assets/img/ko-fi.jpg' alt='APOIA.se' class='img-fluid img-thumbnail rounded-circle' style='width: 100px'></p>
                <p>Ko-fi</p>
            </a>
        </div>
    </div>

    <a href="/en/contribute">More info and other ways to contribute ›</a>



    </div><!-- .card-body -->
</div><!-- .card -->


    <div class="card mb-3 d-none d-lg-block">
        <div class="card-header">
            <h3>
                Facebook
            </h3>
        </div>
        <div class="card-body">
            <div id="facebook-page-plugin-wrapper">
                <!-- Facebook Page Plugin -->
                <div class="fb-page" data-href="https://www.facebook.com/LinuxKamarada/" data-tabs="timeline" data-width="" data-height="450" data-small-header="false" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true"><blockquote cite="https://www.facebook.com/LinuxKamarada/" class="fb-xfbml-parse-ignore"><a href="https://www.facebook.com/LinuxKamarada/">Linux Kamarada</a></blockquote></div>
            </div><!-- #facebook-page-plugin-wrapper -->
        </div><!-- .card-body -->
    </div><!-- .card -->



    
        <div class="card mb-3 d-none d-lg-block">
            <div class="card-header">
                <h3>
                    Twitter
                </h3>
            </div>
            <div class="card-body">
                <!-- Twitter Embedded Timeline -->
                <a class="twitter-timeline" data-height="450" data-theme="light" data-link-color="#4caf50" href="https://twitter.com/LinuxKamaradaWW?ref_src=twsrc%5Etfw">Tweets by LinuxKamaradaWW</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
            </div><!-- .card-body -->
        </div><!-- .card -->
    


<div class="card mb-3">
    <div class="card-header">
        <h3>
            <a name="author"></a>
            
                Author
            
        </h3>
    </div>
    <div class="card-body" itemprop="author" itemscope itemtype="http://schema.org/Person">
        
            <p class="text-center">
                <a href='https://secure.gravatar.com/avatar/5415f4267b44aa9f51b6f89ac4d1656b' title='Antônio Vinícius'>
                    <img src='https://secure.gravatar.com/avatar/5415f4267b44aa9f51b6f89ac4d1656b' alt='Antônio Vinícius' class='img-fluid img-thumbnail rounded-circle'>
                </a>
            </p>
        
        
            <p class="lead text-center" itemprop="name">
                
                    Antônio Vinícius
                
            </p>
        
        <ul class="contact-list list-unstyled">
            
                <li><a href="http://www.vinyanalista.com.br" itemprop="url"><i class="fas fa-globe"></i> http://www.vinyanalista.com.br</a></li>
            
        </ul>
    </div><!-- .card-body -->
</div><!-- .card -->

                    </div>
                </div>
            </div>

            <footer class="footer">
    <div class="container">
        Copyleft 2021 <a href='#author'>Antônio Vinícius</a>. All rights reversed. Based on <a href='https://github.com/vinyanalista/material-jekyll-plus'>Material site template for Jekyll PLUS</a>.
    </div>
</footer>

<meta itemprop="description" content="Commonly, restricted access systems authenticate their users by requesting a combination of username (a.k.a login) and password.A brute-force attack is a type of attack that consists in trying to guess a combination of username and password that grants access to a system. If an attacker knows at least an existing username, they are already halfway,...">


    <div itemprop="image" itemscope itemtype="http://schema.org/ImageObject">
        <meta itemprop="url" content="https://kamarada.github.io/files/2019/12/fail2ban.jpg"/>
        <!--<meta itemprop="width" content=""/>--><!-- TODO Image width -->
        <!--<meta itemprop="height" content=""/>--><!-- TODO Image height -->
    </div>



    <meta itemprop="inLanguage" content="en"/>



    
        <!-- Disqus -->
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES * * */
            
                var disqus_config = function () {
                    this.language = "en";
                };
            
            var disqus_shortname = 'kamaradaww';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var s = document.createElement('script'); s.async = true;
                s.type = 'text/javascript';
                s.src = '//' + disqus_shortname + '.disqus.com/count.js';
                (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
            }());
        </script>
        <!-- Disqus End -->
    



    <!-- Google AdSense -->
    
        
    <!-- Google AdSense -->
    <ins class="adsbygoogle" id="content_ad_unit_2"
        style="display:block"
        data-ad-client="ca-pub-5193467168351289"
        data-ad-slot="4375857858"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <!-- End Google AdSense -->
    <div class="alert alert-danger please-allow-ads d-none" role="alert">
        <div class="media">
            <img class="mr-3" src="/assets/icons/other/detective_penguin.svg" alt="Detective penguin" style="max-width: 64px;">
            <div class="media-body">
                <h6 class="alert-heading mt-0">Have you seen the ad that should be here?</h6>
                It seems like you're using an ad blocker. But we depend on advertising to keep creating quality content for you to enjoy for free. If you enjoy our content, please support our website by disabling your ad blocker. Alternatively, if you come here often, please consider <a href='/en/contribute'>making a donation</a>.
            </div>
        </div>
    </div>


    

    <script type="text/javascript">
        adsbygoogle = window.adsbygoogle || [];

        $(document).ready(function(){
            
                var $ad = $('#content_ad_unit_2');
                var $please_allow_ads = $('#content_ad_unit_2 + .please-allow-ads');
                var $posts = $('.blog-post');
                if (($posts.length > 1) || ($('.blog-archive-title').length > 0)) {
                    // Post listing
                    var post;
                    if ($posts.length > 2) {
                        post = random_number(2, $posts.length);
                    } else {
                        post = 2;
                    }
                    $posts.eq(post - 1).find('.blog-post-content .row').after($ad);
                    $('#content_ad_unit_2').after($please_allow_ads);
                } else {
                    // Page or post
                    var $paragraphs = $('.blog-post-content p').filter(function() {
                        return ($(this).closest('.no-ads-here').length == 0);
                    });
                    if ($paragraphs.length > 0) {
                        var paragraph;
                        if ($paragraphs.length > 1) {
                            paragraph = random_number(1, $paragraphs.length);
                        } else {
                            paragraph = 1;
                        }
                        $paragraphs.eq(paragraph - 1).after($ad);
                        $('#content_ad_unit_2').after($please_allow_ads);
                    } else {
                        $ad.remove();
                        $please_allow_ads.remove();
                    }
                }
            
            if (window.canRunAds === undefined) {
                // Ad blocker detected
                $('.please-allow-ads').removeClass('d-none');
            } else {
                $('.adsbygoogle').each(function(index, element){
                    adsbygoogle.push({});
                });
            }
        });
    </script>
    <!-- Google AdSense End -->



            
        </main>
    </div><!-- .bmd-layout-container -->

    <div class="modal fade" id="language-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel"><i class="fas fa-globe-americas" aria-hidden="true"></i> Translations</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <div class="list-group list-group-flush bmd-list-group-sm">
                    
                    
                        <a href="#" class="list-group-item list-group-item-action disabled">English</a>
                        
                        
                            <a class="list-group-item list-group-item-action translation-en" href="https://kamarada.github.io/en/2020/01/07/mitigating-brute-force-attacks-on-linux-using-fail2ban/">This page in English</a>
                        
                        <a class="list-group-item list-group-item-action" href="https://kamarada.github.io/en/">English home page</a>
                    
                        <a href="#" class="list-group-item list-group-item-action disabled">Português</a>
                        
                        
                            <a class="list-group-item list-group-item-action translation-pt" href="https://kamarada.github.io/pt/2019/12/14/mitigando-ataques-de-forca-bruta-no-linux-com-fail2ban/">Esta página em Português</a>
                        
                        <a class="list-group-item list-group-item-action" href="https://kamarada.github.io/pt/">Página inicial em Português</a>
                    
                    <a href="#" class="list-group-item list-group-item-action disabled">Other languages (by Google Translate)</a>
                    <a class="list-group-item list-group-item-action" href="http://translate.google.com/translate?js=n&sl=en&u=https://kamarada.github.io/en/2020/01/07/mitigating-brute-force-attacks-on-linux-using-fail2ban/">Translate this page</a>
                </div>

            </div><!--.modal-body-->
        </div><!--.modal-content-->
    </div><!--.modal-dialog-->
</div><!--#language-modal-->

</body>
</html>
